# Система управления аварийными сигналами

Веб-приложение на Django для настройки и управления аварийными сигналами с возможностью экспорта конфигурации в JSON формат.

## Возможности

- ✅ Создание и управление таблицами аварийных сигналов
- ✅ Настройка аварийных сигналов с различными типами логики:
  - **discrete** - дискретное событие (0/не 0)
  - **analog** - аналоговое событие с пределами
  - **change** - любое изменение события
- ✅ Поддержка различных классов аварий:
  - **error** - ошибка (высокий приоритет)
  - **warn** - предупреждение
  - **info** - информация
  - **all_alarm** - все сообщения
- ✅ Динамическое отображение полей в зависимости от выбранной логики
- ✅ Экспорт конфигурации в JSON файл
- ✅ Современный и удобный интерфейс на Bootstrap 5

## Структура данных

### Поля аварийного сигнала

| Поле | Тип | Описание |
|------|-----|----------|
| `alarm_class` | ALARM_CLASS | Класс тревоги |
| `table_id` | number | Номер таблицы сообщения |
| `logic` | LOGIC | Способ наблюдения за событием |
| `channel` | string | Имя канала при logic="discrete"/"analog"/"change" |
| `limit_type` | LIMIT_TYPE | Типы ограничений при logic="analog" |
| `low` | number | Значение нижнего предела при logic="analog" |
| `high` | number | Значение верхнего предела при logic="analog" |
| `discrete_val` | number | Значение предела для logic="discrete" |
| `msg` | string | Текст сообщения |
| `hyst_low` | number | Гистерезис для нижнего предела |
| `hyst_high` | number | Гистерезис для верхнего предела |
| `ch_low` | string | Канал для нижнего предела |
| `ch_high` | string | Канал для верхнего предела |
| `confirm_method` | CONFIRM_METHOD | Способ подтверждения события |
| `prior` | number | Приоритет тревоги (1-1000) |

### Константы

#### LOGIC (Способ наблюдения)
- `discrete` - Событие дискретное: ноль/отличное от ноля
- `analog` - Событие аналоговое
- `change` - Обрабатывается любое изменение события

#### LIMIT_TYPE (Типы ограничений)
- `low` - Событие ограничено значением снизу
- `high` - Событие ограничено значением сверху
- `low_high` - Событие ограничено значениями снизу и сверху

#### ALARM_CLASS (Классы тревог)
- `error` - Ошибка
- `warn` - Предупреждение
- `info` - Информирование
- `all_alarm` - Все сообщения

## Установка и запуск

### Требования

- Python 3.8+
- Django 4.2.7
- SQLite (встроенная)

### Установка

1. Клонируйте репозиторий:
```bash
git clone <repository-url>
cd alarmManagerConfig
```

2. Создайте и активируйте виртуальное окружение:
```bash
# Windows
python -m venv venv
venv\Scripts\activate

# Linux/Mac
python -m venv venv
source venv/bin/activate
```

3. Установите зависимости:
```bash
pip install -r requirements.txt
```

4. Выполните миграции:
```bash
python manage.py makemigrations
python manage.py migrate
```

5. Создайте суперпользователя (опционально):
```bash
python manage.py createsuperuser
```

6. Запустите сервер разработки:
```bash
python manage.py runserver
```

7. Откройте браузер и перейдите по адресу: http://127.0.0.1:8000/

## Работа с виртуальным окружением

### Активация виртуального окружения

При каждом новом сеансе работы с проектом необходимо активировать виртуальное окружение:

```bash
# Windows
venv\Scripts\activate

# Linux/Mac
source venv/bin/activate
```

### Деактивация виртуального окружения

Для выхода из виртуального окружения:

```bash
deactivate
```

### Обновление зависимостей

При добавлении новых зависимостей обновите файл `requirements.txt`:

```bash
pip freeze > requirements.txt
```

## Использование

### Главная страница
- Просмотр статистики (количество таблиц и аварийных сигналов)
- Быстрые действия (создание таблиц, сигналов, экспорт)
- Список последних аварийных сигналов

### Управление таблицами аварий
- Создание новых таблиц с названием и описанием
- Редактирование существующих таблиц
- Удаление таблиц (с предупреждением о связанных сигналах)

### Управление аварийными сигналами
- Создание новых аварийных сигналов
- Динамическое отображение полей в зависимости от выбранной логики
- Редактирование существующих сигналов
- Удаление сигналов

### Экспорт конфигурации
- Кнопка "Экспорт JSON" на главной странице
- Автоматическое скачивание файла `alarm_config.json`
- Содержит все таблицы и конфигурации аварийных сигналов

## Структура проекта

```
alarmManagerConfig/
├── alarm_manager/          # Основной проект Django
│   ├── settings.py        # Настройки проекта
│   ├── urls.py           # Главные URL-маршруты
│   └── wsgi.py           # WSGI конфигурация
├── alarms/               # Приложение аварийных сигналов
│   ├── models.py         # Модели данных
│   ├── views.py          # Представления
│   ├── forms.py          # Формы
│   ├── urls.py           # URL-маршруты приложения
│   └── migrations/       # Миграции базы данных
├── templates/            # HTML шаблоны
│   ├── base.html         # Базовый шаблон
│   └── alarms/           # Шаблоны приложения
├── static/               # Статические файлы
├── requirements.txt      # Зависимости Python
├── manage.py            # Скрипт управления Django
└── README.md            # Документация
```

## База данных

Приложение использует SQLite базу данных, которая создается автоматически при выполнении миграций. Файл базы данных: `db.sqlite3`

## Лицензия

Этот проект создан в образовательных целях.

## Поддержка

При возникновении проблем или вопросов создайте issue в репозитории проекта. 
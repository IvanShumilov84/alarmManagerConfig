# Создание установщика через PyInstaller

## Обзор

Этот проект использует PyInstaller для создания автономного исполняемого файла Windows, который включает в себя Django сервер и все необходимые зависимости.

## Требования

- Python 3.7-3.11 (PyInstaller не поддерживает Python 3.12+)
- Windows 10/11
- Виртуальное окружение с установленными зависимостями

## Быстрая сборка

### Вариант 1: Через batch файл (рекомендуется)
```bash
build_installer.bat
```

### Вариант 2: Через Python скрипт
```bash
# Активируем виртуальное окружение
venv\Scripts\activate

# Запускаем сборку
python build_pyinstaller.py
```

## Что создается

После успешной сборки в корне проекта появится:

1. **AlarmManager_Setup.zip** - основной установщик (26-30 МБ)
2. **dist/** - папка с распакованными файлами:
   - `AlarmManager.exe` - исполняемый файл
   - `README.txt` - инструкции по установке
   - `Запуск_приложения.bat` - удобный запуск

## Структура установщика

```
AlarmManager_Setup.zip
├── AlarmManager.exe          # Основной исполняемый файл
├── README.txt               # Инструкции пользователя
└── Запуск_приложения.bat    # Batch файл для запуска
```

## Особенности сборки

### Включенные компоненты
- Django 5.2.4 и все зависимости
- Все файлы проекта (models, views, templates, static)
- База данных SQLite
- Автоматический запуск сервера
- Автоматическое открытие браузера

### Конфигурация PyInstaller
- **hiddenimports**: Все необходимые Django модули
- **datas**: Все файлы проекта и статические ресурсы
- **console**: True (показывает консоль для отладки)
- **upx**: True (сжатие исполняемого файла)

## Установка и использование

### Для конечного пользователя

1. **Распаковка**: Извлеките `AlarmManager_Setup.zip` в удобное место
2. **Запуск**: Дважды кликните на `AlarmManager.exe` или `Запуск_приложения.bat`
3. **Использование**: Браузер откроется автоматически на http://127.0.0.1:8000

### Возможные проблемы

#### Ошибка "VCRUNTIME140.dll не найден"
**Решение**: Установите Microsoft Visual C++ Redistributable 2015-2022

#### Антивирус блокирует файл
**Решение**: Добавьте папку в исключения антивируса

#### Сервер не запускается
**Решение**: 
- Проверьте, что порт 8000 свободен
- Запустите от имени администратора
- Проверьте файрвол

## Оптимизация размера

### Текущий размер: ~26 МБ

Для уменьшения размера можно:

1. **Исключить ненужные модули** в `build_pyinstaller.py`:
```python
excludes=['matplotlib', 'numpy', 'scipy'],  # если не используются
```

2. **Использовать UPX** (уже включен):
```python
upx=True,
```

3. **Исключить отладочную информацию**:
```python
debug=False,
strip=True,
```

## Отладка

### Просмотр логов
При запуске `AlarmManager.exe` в консоли отображаются все логи Django.

### Тестирование сборки
```bash
# Запуск тестовой сборки
cd dist
./AlarmManager.exe
```

### Проверка зависимостей
```bash
# Проверка включенных модулей
python -c "import PyInstaller; print(PyInstaller.__version__)"
```

## Альтернативы

### Если PyInstaller не работает

1. **Nuitka** (поддерживает Python 3.13+):
   ```bash
   pip install nuitka
   python -m nuitka --standalone run_server.py
   ```

2. **Auto-py-to-exe** (GUI для PyInstaller):
   ```bash
   pip install auto-py-to-exe
   auto-py-to-exe
   ```

3. **cx_Freeze**:
   ```bash
   pip install cx_Freeze
   python setup.py build
   ```

## Обновление установщика

При изменении кода:

1. Обновите код в проекте
2. Запустите `build_installer.bat`
3. Новый `AlarmManager_Setup.zip` заменит старый

## Распространение

### Рекомендуемые способы
- **GitHub Releases**: Загрузите `AlarmManager_Setup.zip`
- **Облачное хранилище**: Google Drive, Dropbox, OneDrive
- **Веб-сайт**: Создайте страницу загрузки

### Информация для пользователей
- Размер: ~26 МБ
- Система: Windows 10/11
- Архитектура: x64
- Зависимости: Не требуются (все включено)

## Поддержка

При проблемах со сборкой:

1. Проверьте версию Python (должна быть 3.7-3.11)
2. Убедитесь, что все зависимости установлены
3. Проверьте права доступа к папкам
4. Очистите папки `build/` и `dist/` перед повторной сборкой 